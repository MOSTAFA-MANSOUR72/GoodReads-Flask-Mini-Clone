{% extends 'home.html' %}
{% block title %} {{title}} - BookTracker {% endblock %}

{% block container %}
<div class="mb-8">
  <h1 class="text-3xl font-bold text-gray-900 mb-2">{{title}}</h1>
  <div class="h-1 w-20 bg-gradient-to-r from-primary-600 to-blue-600 rounded"></div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
  {% for book in books %}
  <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
    <!-- Book Actions (if user owns the book) -->
    {% if book.user_id == user_id and title == "My Books" %}
    <div class="absolute top-2 right-2 z-10 flex space-x-2">
      <form action="{{ url_for('views.update_book', book_id=book.id) }}" method="get" class="inline">
        <button type="submit" class="p-2 bg-amber-500 text-white rounded-full hover:bg-amber-600 transition-colors shadow-lg">
          <i class="fas fa-edit text-sm"></i>
        </button>
      </form>
      <form action="{{ url_for('views.delete_book', book_id=book.id) }}" method="post" class="inline" onsubmit="return confirm('Are you sure you want to delete this book?')">
        <button type="submit" class="p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg">
          <i class="fas fa-trash text-sm"></i>
        </button>
      </form>
    </div>
    {% endif %}
    
    <!-- Book Cover -->
    <div class="relative">
      <img src="{{url_for('static', filename=book.cover_image_url)}}" alt="{{book.title}} Cover" class="w-full h-64 object-cover">
      <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
    </div>
    
    <!-- Book Details -->
    <div class="p-6">
      <h3 class="text-xl font-bold text-gray-900 mb-2 line-clamp-2">{{ book.title }}</h3>
      <p class="text-primary-600 font-medium mb-2">{{ book.author }}</p>
      <p class="text-gray-600 text-sm mb-3 line-clamp-3">{{ book.description }}</p>
      <div class="flex items-center text-sm text-gray-500 mb-4">
        <i class="fas fa-file-alt mr-2"></i>
        <span>{{book.pages_number}} pages</span>
      </div>
      
      <!-- Reading Status -->
      {% if book.id in local_completed_books %}
      <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
        <div class="flex items-center text-green-800">
          <i class="fas fa-check-circle mr-2"></i>
          <span class="font-medium">Completed</span>
        </div>
        <p class="text-green-600 text-sm mt-1">{{local_completed_books[book.id]}}</p>
      </div>
      <form action="{{ url_for('views.delete_completed_book', book_id=book.id)}}" method="post">
        <button type="submit" class="w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium">
          <i class="fas fa-times mr-2"></i>Remove from Completed
        </button>
      </form>
      {% else %}
      <form action="{{ url_for('views.update_currently_reading', book_id=book.id) }}" method="post">
        {% if book.id in current_reading_books %}
        <button type="submit" class="w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium">
          <i class="fas fa-bookmark mr-2"></i>Remove from Currently Reading
        </button>
        {% else %}
        <button type="submit" class="w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium">
          <i class="fas fa-bookmark mr-2"></i>Add to Currently Reading
        </button>
        {% endif %}
      </form>
      {% endif %}
    </div>
  </div>
  {% endfor %}
</div>

{% if not books %}
<div class="text-center py-12">
  <i class="fas fa-book-open text-gray-300 text-6xl mb-4"></i>
  <h3 class="text-xl font-medium text-gray-900 mb-2">No books found</h3>
  <p class="text-gray-500 mb-6">Start building your library by adding some books!</p>
  <a href="{{url_for('views.addBook')}}" class="inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">
    <i class="fas fa-plus mr-2"></i>Add Your First Book
  </a>
</div>
{% endif %}
{% endblock %}
