{% extends 'home.html' %}
{% block title %} {{title}} - BookTracker {% endblock %}

{% block container %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <!-- Books to Explore -->
  <div class="lg:col-span-2">
    <div class="mb-6">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">{{title}}</h1>
      <div class="h-1 w-20 bg-gradient-to-r from-primary-600 to-blue-600 rounded"></div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {% for book in books %}
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="relative">
          <img src="{{url_for('static', filename=book.cover_image_url)}}" alt="{{book.title}} Cover" class="w-full h-48 object-cover">
          <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
        </div>
        
        <div class="p-6">
          <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2">{{ book.title }}</h3>
          <p class="text-primary-600 font-medium mb-2">{{ book.author }}</p>
          <p class="text-gray-600 text-sm mb-3 line-clamp-3">{{ book.description }}</p>
          <div class="flex items-center text-sm text-gray-500 mb-4">
            <i class="fas fa-file-alt mr-2"></i>
            <span>{{book.pages_number}} pages</span>
          </div>
          
          <!-- Reading Status -->
          {% if book.id in local_completed_books %}
          <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
            <div class="flex items-center text-green-800">
              <i class="fas fa-check-circle mr-2"></i>
              <span class="font-medium">Completed</span>
            </div>
            <p class="text-green-600 text-sm mt-1">{{local_completed_books[book.id]}}</p>
          </div>
          <form action="{{ url_for('views.delete_completed_book', book_id=book.id)}}" method="post">
            <button type="submit" class="w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium">
              <i class="fas fa-times mr-2"></i>Remove from Completed
            </button>
          </form>
          {% else %}
          <form action="{{ url_for('views.update_currently_reading', book_id=book.id) }}" method="post">
            {% if book.id in current_reading_books %}
            <button type="submit" class="w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium">
              <i class="fas fa-bookmark-slash mr-2"></i>Remove from Currently Reading
            </button>
            {% else %}
            <button type="submit" class="w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium">
              <i class="fas fa-bookmark mr-2"></i>Add to Currently Reading
            </button>
            {% endif %}
          </form>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
    
    {% if not books %}
    <div class="text-center py-12">
      <i class="fas fa-compass text-gray-300 text-6xl mb-4"></i>
      <h3 class="text-xl font-medium text-gray-900 mb-2">No books to explore</h3>
      <p class="text-gray-500 mb-6">Check back later for new books to discover!</p>
    </div>
    {% endif %}
  </div>
  
  <!-- Make Friends Sidebar -->
  <div class="lg:col-span-1">
    <div class="bg-white rounded-xl shadow-lg overflow-hidden sticky top-24">
      <div class="bg-gradient-to-r from-green-600 to-teal-600 px-6 py-4">
        <h2 class="text-xl font-bold text-white flex items-center">
          <i class="fas fa-user-plus mr-3"></i>
          Make Friends
        </h2>
      </div>
      
      <div class="p-6 max-h-96 overflow-y-auto">
        {% for user in users %}
        <div class="flex items-center space-x-3 mb-6 last:mb-0">
          <img src="{{url_for('static', filename=user.cover_image_url)}}" alt="{{user.username}}" class="w-12 h-12 rounded-full object-cover">
          <div class="flex-1 min-w-0">
            <h4 class="text-sm font-medium text-gray-900 truncate">{{user.username}}</h4>
            <p class="text-xs text-gray-500 truncate">{{user.email}}</p>
            <div class="mt-2">
              {% if user in followed_users %}
              <form action="{{ url_for('views.unfollow', user_id=user.id) }}" method="post" class="inline">
                <button class="px-3 py-1 text-xs bg-red-100 text-red-700 rounded-full hover:bg-red-200 transition-colors">
                  <i class="fas fa-user-minus mr-1"></i>Unfollow
                </button>
              </form>
              {% else %}
              <form action="{{ url_for('views.follow', user_id=user.id) }}" method="post" class="inline">
                <button class="px-3 py-1 text-xs bg-primary-100 text-primary-700 rounded-full hover:bg-primary-200 transition-colors">
                  <i class="fas fa-user-plus mr-1"></i>Follow
                </button>
              </form>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
        
        {% if not users %}
        <div class="text-center py-8">
          <i class="fas fa-users text-gray-300 text-3xl mb-3"></i>
          <p class="text-gray-500 text-sm">No users to follow yet</p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
